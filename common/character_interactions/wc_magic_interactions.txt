# Arcane
wc_magic_cast_spell_order_arcane_intellect_interaction = {
	category = interaction_category_wc_order_magic
	common_interaction = yes
	icon = order_arcane_intellect_interaction
	prompt = wc_magic_interaction_choose_caster_prompt_line

	populate_actor_list = {
		scope:actor = {
			if = {
				limit = { wc_magic_spell_order_arcane_intellect_unlocked_trigger = yes }
				add_to_list = characters
			}
			every_courtier = {
				limit = { wc_magic_spell_order_arcane_intellect_unlocked_trigger = yes }
				add_to_list = characters
			}
		}
	}

	is_shown = {
		scope:actor = {
			OR = {
				wc_magic_spell_order_arcane_intellect_unlocked_trigger = yes
				any_courtier = { wc_magic_spell_order_arcane_intellect_unlocked_trigger = yes }
			}
		}
	}

	is_valid_showing_failures_only = {
		scope:recipient = {
			NOT = { has_character_modifier = wc_magic_spell_order_arcane_intellect_modifier }
		}
	}

	has_valid_target_showing_failures_only = {
		scope:secondary_actor = {
			var:wc_current_mana_variable >= wc_magic_spell_order_arcane_intellect_cost_mana_value
		}
	}

	send_options_exclusive = no

	send_option = {
		flag = wc_channel_spell_flag
		localization = WC_MAGIC_CASTER_CHANNEL_OPTION
	}

	on_accept = {
		if = {
			limit = { always = scope:wc_channel_spell_flag }

			wc_CASTER_start_channeling_SPELL_on_TARGET_effect = {
				SPELL = order_arcane_intellect
				CASTER = scope:secondary_actor
				TARGET = scope:recipient
			}
		}
		else = {
			scope:secondary_actor = {
				wc_CHANGE_mana_by_VALUE_effect = {
					CHANGE = subtract
					VALUE = wc_magic_spell_order_arcane_intellect_cost_mana_value
				}
			}
			scope:recipient = {
				while = {
					count = scope:secondary_actor.wc_magic_spell_order_arcane_intellect_effect_value

					add_character_modifier = {
						modifier = wc_magic_spell_order_arcane_intellect_modifier
						days = wc_magic_spell_order_arcane_intellect_duration_days_value
					}
				}
			}
		}
	}

	auto_accept = yes
}

