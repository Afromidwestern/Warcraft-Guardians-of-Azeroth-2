develop_the_undercity = { 
    ai_check_interval = 6
	sort_order = 1
	picture = "gfx/interface/illustrations/decisions/decision_realm.dds"
	desc = develop_the_undercity_desc
	selection_tooltip = develop_the_undercity_tooltip
	major = yes

	is_shown = {
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:develop_the_undercity
			}
		}

		root.culture = culture:forsaken

		has_title = title:c_lordaeron
	}

	is_valid = {
		piety_level >= 2

		prestige_level >= 2

		AND = {
			religion = {is_in_family = rf_void}
			OR = { 
				culture = culture:forsaken
				culture = {
					any_parent_culture = { 
						count >= 1
						culture = culture:forsaken
					}
				}
			}
		}
	}

	cost = { 
		gold = 100
	}

	effect = {
		# Can only happen once
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:develop_the_undercity
		}

		if = { 
			limit = { 
				NOT = { capital_county = title:c_lordaeron } 
			}
			set_realm_capital = title:c_lordaeron
		}

		hidden_effect = {
			trigger_event = lordaeron.1001
			if = { 
				limit = { 
					AND = { 
						exists = top_liege
						OR = { 
							top_liege = { 
								culture = culture:forsaken 
							}
							top_liege = { 
								scope:culture = {any_parent_culture = { 
									count >= 1
									culture = culture:forsaken
							}}}
						}
					}
				}
				set_global_variable = { name = sylvanas_character value = top_liege }
			} else = { 
				set_global_variable = { name = sylvanas_character value = root }
			}
		}
		# title:b_lordaeron.title_province = { 
		# 	remove_building = ruined_palace_01
		# 	add_special_building = ruined_palace_02 
		# }
		add_piety = 1000 #test

		show_as_tooltip = { 
			custom_tooltip = develop_the_undercity_effects
		}
		title:b_lordaeron.title_province = {
			add_province_modifier = { 
				modifier = wc_building_undercity
				years = 2
			}
		}
	}
	
	ai_will_do = {
		base = 100
	}
}
