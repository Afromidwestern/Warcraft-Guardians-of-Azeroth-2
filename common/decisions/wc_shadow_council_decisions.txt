#############################################
# Taking the Blackrock Mountain				#
# by ElMariuso								#
#############################################
taking_blackrock_mountain_decision = {
	picture = "gfx/interface/illustrations/decisions/shadow_council.dds"
	major = yes

	ai_check_interval = 120

	desc = taking_blackrock_mountain_decision_desc

	is_shown = {
		# Standard filter checks.
		###taking_blackrock_mountain_basic_filter_trigger = yes
		
		# Must be in the vague region.
		##any_held_title = {
		##	tier = tier_kingdom
		##	title_province = { 
		##	OR = {
		##		geographical_region = world_eastern_kingdoms_azeroth_black_morass
		##		geographical_region = world_eastern_kingdoms_azeroth_azeroth
		##	}
		##	NOT = {
		###		geographical_region = world_eastern_kingdoms_azeroth_redridge_mountains
		##	}
		##	}
		##}
		
		# Not repeatable.
		NOT = {
			is_target_in_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:taking_blackrock_mountain_decision
			}
		}
		game_start_date < 585.1.1

		is_shadow_council_horde_invasion_trigger = yes
	}

	is_valid = {
		# Some extra standard-ish filtering.
		###taking_blackrock_mountain_additional_filter_trigger = yes
		
		# Should have a decent prestige level.
		###prestige_level >= medium_prestige_level
		
		## Must being powerful vassal of the Horde or being Warchief
		OR = {
			custom_description = {
				text = taking_blackrock_mountain.powerful_vassal.tt
				is_powerful_vassal_of = title:e_horde.holder
			}
			custom_description = {
				text = taking_blackrock_mountain.warchief_of_the_horde.tt
				any_held_title = { this = title:e_horde }
			}
		}
		
		## The Warchief must be corruptist or sargerist
		OR = {
			custom_description = {
				text = taking_blackrock_mountain.warchief_corruptism.tt
				title:e_horde.holder = {
					has_faith = faith:orcish_fel
				}
			}		
			custom_description = {
				text = taking_blackrock_mountain.warchief_sargerism.tt
				title:e_horde.holder = {
					has_faith = faith:burning_legion_religion
				}
			}
		}
	}

	is_valid_showing_failures_only = {
		is_imprisoned = no
		is_available_adult = yes
	}

	effect = {
		# We can't show the effects in the decision window, since they rely on scopes & the tooltips will error, so just display a preview tooltip instead.
		custom_tooltip = taking_blackrock_mountain.preview.tt
		custom_tooltip = taking_blackrock_mountain.clarification.tt
		
		trigger_event = shadow_council.0010
		
		# Notifying other players is handled in the response event for scope:ntd_recipient, since they might reject it.
		hidden_effect = {
			add_to_global_variable_list = {
				name = unavailable_unique_decisions
				target = flag:taking_blackrock_mountain_decision
			}
		}
	}
	
	ai_potential = {
		always = yes
	}

	ai_will_do = {
		base = 100
	}
}