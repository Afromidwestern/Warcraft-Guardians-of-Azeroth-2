@fortifying_feast_prowess_max = 3

fortifying_feast_bonus_effect = {
	#Backup check for perk
	if = {
		limit = {
			has_perk = fortifying_feast
		}

		# Backup for the variables
		if = {
			limit = {
				NOT = { has_variable = fortifying_feast_prowess_increases }
			}
			set_variable = {
				name = fortifying_feast_prowess_increases
				value = 0
			}
		}

		if = {
			# For tooltip generation, we need to check if we have the variable yet (the backups above won't create the variables until after the effect is actually run).
			limit = {
				NOR = {
					has_variable = fortifying_feast_prowess_increases
				}
			}
			custom_tooltip = fortifying_feast_gain_stats_tt
		}
		else_if = {
			limit = {
				var:fortifying_feast_prowess_increases < @fortifying_feast_prowess_max
			}

			custom_tooltip = fortifying_feast_gain_stats_tt

			send_interface_toast = {
				title = fortifying_feast_gain_message
				left_icon = scope:actor

				add_character_modifier = {
					modifier = fortifying_feast_gain_modifier
				}
			}

			change_variable = {
				name = fortifying_feast_prowess_increases
				add = 1
			}
		}
		else_if = {
			limit = {
				var:fortifying_feast_prowess_increases >= @fortifying_feast_prowess_max
			}
			custom_tooltip = fortifying_feast_gain_stats_tt
		}
	}
}