enforce_the_brotherhood_scripted_effect = {
	# Display simplified results.
	custom_tooltip = create_holy_order_decision_effect_message
	
	
	
	
	# Select a random county.
	random_held_title = {
		limit = { fp1_valid_county_for_jomsvikings_trigger = yes }
		save_scope_as = designated_county
	}
	
	
	
	
	# Select an appropriate barony.
	## If there's an empty space in the capital, we create a castle.
	if = {
		limit = {
			scope:designated_county = {
				any_county_province = { has_holding = no }
			}
		}
		scope:designated_county = {
			random_county_province = {
				limit = { has_holding = no }
				set_holding_type = castle_holding
				barony = { save_scope_as = leased_barony }
			}
		}
	}
	## Otherwise, grab an existing non-capital castle/city.
	else = {
		scope:designated_county = {
			random_county_province = {
				limit = {
					is_county_capital = no
					OR = {
						has_holding_type = castle_holding
						has_holding_type = city_holding
					}
				}
				barony = { save_scope_as = leased_barony }
			}
		}
	}
	# Create a suitable leader for the Jomsvikings.
	create_character = {
		template = fp1_jomsviking_bigwig
		location = scope:leased_barony.title_province
		save_scope_as = leader
	}
	# Create the actual holy order.
	create_holy_order_neutral_effect = {
		LEADER = scope:leader
		CAPITAL = scope:leased_barony
		NEW_HO_SCOPE = new_holy_order
		FOUNDER = scope:founder
	}
	hidden_effect = {
		scope:leader = {
			add_trait = order_member
			add_piety_level = 2
			add_gold = holy_order_starting_gold
			every_courtier = { add_trait = order_member }
		}
	}
	# Make the local settlement Jomsberg.
	## Rename it.
	scope:leased_barony = { set_title_name = b_jomsberg }
	## Give it some buildings.
	hidden_effect = {
		scope:leased_barony.title_province = {
			# Walls & Towers.
			if = {
				limit = {
					NOT = { has_building_or_higher = curtain_walls_01 }
				}
				# If it doesn't have a free building slot, give it one.
				if = {
					limit = { free_building_slots = 0 }
					add_building_slot = 1
				}
				# Add the building.
				add_building = curtain_walls_01
			}
			# Barracks.
			if = {
				limit = {
					NOT = { has_building_or_higher = barracks_01 }
				}
				# If it doesn't have a free building slot, give it one.
				if = {
					limit = { free_building_slots = 0 }
					add_building_slot = 1
				}
				# Add the building.
				add_building = barracks_01
			}
			# Military Camps.
			if = {
				limit = {
					NOT = { has_building_or_higher = military_camps_01 }
				}
				# If it doesn't have a free building slot, give it one.
				if = {
					limit = { free_building_slots = 0 }
					add_building_slot = 1
				}
				# Add the building.
				add_building = military_camps_01
			}
		}
	}
	## Mark it so it can be renamed if the order is ever destroyed.
	set_global_variable = {
		name = jomsberg_location
		value = scope:leased_barony
	}
	# And the Grandmaster of Jomsberg certainly looks favourably on their patron.
	## Hidden because the title doesn't play nicely with characters created in the same immediate block.
	hidden_effect = {
		scope:founder = { set_relation_friend = { reason = friend_forging_jomsvikings target = scope:leader } }
	}
	# Mark the Jomsvikings as existing & make them easily accessible
	set_global_variable = {
		name = jomsvikings_title
		value = scope:leader.primary_title
	}
	# Achievement flag.
	add_achievement_flag_effect = { FLAG = achievement_non_nobis_domine_flag }
	# Some minor misc effects.
	create_holy_order_effect = yes
	scope:leader.primary_title = { set_coa = ho_jomsvikings }
	
	
	
	
	
	
	
	
	
	
	# Flag the Brotherhood of Northshire as forged.
	hidden_effect = {
		add_to_global_variable_list = {
			name = unavailable_unique_decisions
			target = flag:flag_enforce_brotherhood
		}
	}
}