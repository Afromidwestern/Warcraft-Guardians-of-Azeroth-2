check_available_laws_effect = {
	if = {
		limit = { realm_law_use_crown_authority = yes }
		# remove_realm_crown_authority_effect = yes
		remove_realm_tribal_authority_effect = yes
		remove_realm_dark_authority_effect = yes
		
		if = {
			limit = { has_realm_crown_authority_trigger = no }
			
			add_realm_law_skip_effects = crown_authority_0
		}
	}
	else_if = {
		limit = { realm_law_use_tribal_authority = yes }
		remove_realm_crown_authority_effect = yes
		# remove_realm_tribal_authority_effect = yes
		remove_realm_dark_authority_effect = yes
		
		if = {
			limit = { has_realm_tribal_authority_trigger = no }
			
			add_realm_law_skip_effects = tribal_authority_0
		}
	}
	else_if = {
		limit = { realm_law_use_dark_authority = yes }
		remove_realm_crown_authority_effect = yes
		remove_realm_tribal_authority_effect = yes
		# remove_realm_dark_authority_effect = yes
		
		if = {
			limit = { has_realm_dark_authority_trigger = no }
			
			add_realm_law_skip_effects = dark_authority_0
			if = { limit = { NOT = { exists = var:dark_frenzy } } set_dark_frenzy_effect = yes }
			update_dark_authority_laws_effect = yes
		}
	}
	
	if = {
		limit = {
			can_have_dark_succession_law_trigger = yes
			NOT = { has_realm_law = dark_succession_law }
		}
		add_realm_law_skip_effects = dark_succession_law
	}
}

remove_realm_crown_authority_effect = {
	if = { limit = { has_realm_law = crown_authority_0 } remove_realm_law = crown_authority_0 }
	else_if = { limit = { has_realm_law = crown_authority_1 } remove_realm_law = crown_authority_1 }
	else_if = { limit = { has_realm_law = crown_authority_2 } remove_realm_law = crown_authority_2 }
	else_if = { limit = { has_realm_law = crown_authority_3 } remove_realm_law = crown_authority_3 }
}
remove_realm_tribal_authority_effect = {
	if = { limit = { has_realm_law = tribal_authority_0 } remove_realm_law = tribal_authority_0 }
	else_if = { limit = { has_realm_law = tribal_authority_1 } remove_realm_law = tribal_authority_1 }
	else_if = { limit = { has_realm_law = tribal_authority_2 } remove_realm_law = tribal_authority_2 }
	else_if = { limit = { has_realm_law = tribal_authority_3 } remove_realm_law = tribal_authority_3 }
}
remove_realm_dark_authority_effect = {
	if = { limit = { has_realm_law = dark_authority_0 } remove_realm_law = dark_authority_0 }
	else_if = { limit = { has_realm_law = dark_authority_1 } remove_realm_law = dark_authority_1 }
	else_if = { limit = { has_realm_law = dark_authority_2 } remove_realm_law = dark_authority_2 }
	else_if = { limit = { has_realm_law = dark_authority_3 } remove_realm_law = dark_authority_3 }
	
	remove_dark_frenzy_effect = yes
}

### Dark Frenzy system
set_dark_frenzy_effect = {
	set_variable = { name = dark_frenzy value = start_dark_frenzy_value }
	start_yearly_dark_frenzy_pulse_effect = yes
}
change_dark_frenzy_effect = {
	custom_description = {
		text = change_dark_frenzy_effect
		value = $VALUE$
		
		change_variable = { name = dark_frenzy add = $VALUE$ }
		clamp_variable = { name = dark_frenzy max = max_dark_frenzy_value min = min_dark_frenzy_value }
		update_dark_authority_laws_effect = yes
	}
}
remove_dark_frenzy_effect = {
	remove_character_flag = yearly_dark_frenzy_pulse_flag
	remove_variable = dark_frenzy
}
inherit_dark_frenzy_effect = {
	if = {
		limit = {
			NOT = { exists = var:dark_frenzy }
			
			exists = $CHARACTER$.var:dark_frenzy
		}
		set_variable = { name = dark_frenzy value = $CHARACTER$.var:dark_frenzy }
		start_yearly_dark_frenzy_pulse_effect = yes
	}
}
start_yearly_dark_frenzy_pulse_effect = {
	if = {
		limit = {
			is_playable_trigger = yes
			realm_law_use_dark_authority = yes
			
			NOT = { has_character_flag = yearly_dark_frenzy_pulse_flag }
		}
		add_character_flag = { flag = yearly_dark_frenzy_pulse_flag years = 2 }
		trigger_event = {
			on_action = yearly_dark_frenzy_pulse
			days = { 30 360 } # To avoid them all firing the same day
		}
	}
}

update_dark_authority_laws_effect = {
	if = {
		limit = { exists = var:dark_frenzy }
		if = {
			limit = { var:dark_frenzy >= dark_frenzy_3_value }
			if = {
				limit = { NOT = { has_realm_law = dark_authority_3 } }
				send_interface_message = {
					type = msg_event_passed_law_good
					title = msg_dark_authority_increased
					add_realm_law = dark_authority_3
				}
			}
		}
		else_if = {
			limit = { var:dark_frenzy >= dark_frenzy_2_value }
			if = {
				limit = { NOT = { has_realm_law = dark_authority_2 } }
				if = {
					limit = {
						OR = {
							has_realm_law = dark_authority_0
							has_realm_law = dark_authority_1
						}
					}
					send_interface_message = {
						type = msg_event_passed_law_good
						title = msg_dark_authority_increased
						add_realm_law = dark_authority_2
					}
				}
				else = {
					send_interface_message = {
						type = msg_event_passed_law_bad
						title = msg_dark_authority_decreased
						add_realm_law = dark_authority_2
					}
				}
			}
		}
		else_if = {
			limit = { var:dark_frenzy >= dark_frenzy_1_value }
			if = {
				limit = { NOT = { has_realm_law = dark_authority_1 } }
				if = {
					limit = { has_realm_law = dark_authority_0 }
					send_interface_message = {
						type = msg_event_passed_law_good
						title = msg_dark_authority_increased
						add_realm_law = dark_authority_1
					}
				}
				else = {
					send_interface_message = {
						type = msg_event_passed_law_bad
						title = msg_dark_authority_decreased
						add_realm_law = dark_authority_1
					}
				}
			}
		}
		else = {
			if = {
				limit = { NOT = { has_realm_law = dark_authority_0 } }
				send_interface_message = {
					type = msg_event_passed_law_bad
					title = msg_dark_authority_decreased
					add_realm_law = dark_authority_0
				}
			}
		}
	}
}

decrease_any_authority_effect = {
	decrease_authority_effect = { AUTHORITY = crown }
	decrease_authority_effect = { AUTHORITY = tribal }
	# decrease_authority_effect = { AUTHORITY = dark }
	
	if = {
		limit = { has_realm_dark_authority_trigger = yes }
		change_dark_frenzy_effect = { VALUE = -30 }
	}
}
increase_any_authority_effect = {
	increase_authority_effect = { AUTHORITY = crown }
	increase_authority_effect = { AUTHORITY = tribal }
	# increase_authority_effect = { AUTHORITY = dark }
	
	if = {
		limit = { has_realm_dark_authority_trigger = yes }
		change_dark_frenzy_effect = { VALUE = 30 }
	}
}
decrease_authority_effect = {
	if = {
		limit = { has_realm_law = $AUTHORITY$_authority_3 }
		add_realm_law = $AUTHORITY$_authority_2
	}
	else_if = {
		limit = { has_realm_law = $AUTHORITY$_authority_2 }
		add_realm_law = $AUTHORITY$_authority_1
	}
	else_if = {
		limit = { has_realm_law = $AUTHORITY$_authority_1 }
		add_realm_law = $AUTHORITY$_authority_0
	}
}
increase_authority_effect = {
	if = {
		limit = { has_realm_law = $AUTHORITY$_authority_3 }
		add_realm_law = $AUTHORITY$_authority_2
	}
	else_if = {
		limit = { has_realm_law = $AUTHORITY$_authority_2 }
		add_realm_law = $AUTHORITY$_authority_1
	}
	else_if = {
		limit = { has_realm_law = $AUTHORITY$_authority_1 }
		add_realm_law = $AUTHORITY$_authority_0
	}
}