init_elemental_fire_spells_effect = {
	add_to_global_variable_list = { name = elemental_fire_spells target = flag:summon_fire_elemental }
}

learn_spell_effect = {
	if = {
		limit = {
			is_unknown_spell_trigger = {
				SPELL_NAME = $SPELL_NAME$
			}
		}
		add_to_variable_list = {
			name = known_spells
			target = $SPELL_NAME$
		}
		add_to_variable_list = {
			name = known_rank_1_spells
			target = $SPELL_NAME$
		}
	}
}

learn_spell_rank_effect = {
	add_to_variable_list = {
		name = known_rank_$RANK$_spells
		target = $SPELL_NAME$
	}
}

change_elemental_favour_effect = {
	if = {
		limit = {
			has_variable = wc_elemental_$TYPE$_favour_variable
		} 
		# nothing
	}
	else = {
		set_variable = {
			name = wc_elemental_$TYPE$_favour_variable
			value = wc_elemental_$TYPE$_favour_current_value
		}
	}
	change_variable = {
		name = wc_elemental_$TYPE$_favour_variable
		$CHANGE$ = $VALUE$
	}
	# TODO : recalculate traits
}

cast_spell_effect = { # Works for tooltips? 
	
	switch = {
		trigger = flag:current_spell_name
		flag:summon_fire_elemental = { cast_summon_fire_elemental_effect = yes }
	}

	if = {
		limit = {
			spell_is_elemental_trigger = { SPELL_NAME = var:current_spell_name }
		}
		set_variable = {
			name = elemental_favour_change
			value = {
				add = var:mana_change
				multiply = 0.5
			}
		}
		if = {
			limit = {
				var:elemental_type = flag:spirit
			}
			change_elemental_favour_effect = {
				TYPE = var:current_spell_class
				CHANGE = add
				VALUE = var:elemental_favour_change
			}
		}
		else_if = {
			limit = {
				var:elemental_type = flag:decay
			}
			change_elemental_favour_effect = {
				TYPE =  var:current_spell_class
				CHANGE = subtract
				VALUE = var:elemental_favour_change
			}
		}
	}
	
	wc_change_mana_by_value_effect = {
		CHANGE = subtract
		VALUE = var:mana_change
	}
	
}

cast_summon_fire_elemental_effect = {
	
	set_variable = {
		name = mana_change
		value = wc_spell_summon_fire_elemental_cost_mana_value
	}

	switch = {
		trigger = var:current_rank_value
		1 = { 
			# get modifier
		}
		2 = {
			# get maa
		}
		3 = {
			# get maa but buffed
		}	
	}
}