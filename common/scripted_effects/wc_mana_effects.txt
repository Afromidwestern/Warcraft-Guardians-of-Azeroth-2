wc_restore_AMOUNT_of_mana_effect = {
	if = {
		limit = { has_variable = wc_current_mana_variable }

		change_variable = { name = wc_current_mana_variable add = $AMOUNT$ }
		clamp_variable = { name = wc_current_mana_variable max = wc_max_mana_value }
	}
	else = { set_variable = { name = wc_current_mana_variable value = wc_max_mana_value } }

	wc_recalculate_prowess_from_mana_effect = yes
}

wc_set_mana_to_AMOUNT_effect = {
	set_variable = { name = wc_current_mana_variable value = $AMOUNT$ }

	clamp_variable = { name = wc_current_mana_variable max = wc_max_mana_value }
	wc_recalculate_prowess_from_mana_effect = yes
}

wc_recalculate_prowess_from_mana_effect = {
	hidden_effect = {
		if = {
			limit = { # So that prowess and related things to it, like army quality, don't flick every month
				trigger_if = {
					limit = { has_variable = wc_current_mana_to_prowess_variable }
					NOT = { wc_current_mana_to_prowess_value = var:wc_current_mana_to_prowess_variable }
				}
				trigger_else = {
					always = yes
				}
			}

			remove_all_character_modifier_instances = wc_prowess_from_available_mana_modifier

			if = {
				limit = { wc_current_mana_to_prowess_value > 0 }

				while = {
					count = wc_current_mana_to_prowess_value

					add_character_modifier = { modifier = wc_prowess_from_available_mana_modifier }
				}
			}
			set_variable = { name = wc_current_mana_to_prowess_variable value = wc_current_mana_to_prowess_value }
		}
	}
}

# wc_spend_X_mana_effect = { change_variable = { name = wc_current_mana_variable add = $VALUE$ } }

wc_start_mana_regeneration_loop_effect = {
	if = {
		limit = {
			NOT = { has_variable = wc_current_mana_variable }
			wc_mana_regeneration_value > 0
			wc_max_mana_value > 0
		}

		wc_set_mana_to_AMOUNT_effect = { AMOUNT = wc_max_mana_value }
		trigger_event = {
			on_action = wc_on_mana_regeneration
			days = { 1 28 } # So it will not cause a major lag on every 1st of each month
		}
	}
}
wc_fill_mana_on_day_one_from_perks_crutch_effect = { # Crutch for mages to have full mana on day 1
	if = {
		limit = { game_start_day_trigger = yes }

		wc_set_mana_to_AMOUNT_effect = { AMOUNT = wc_max_mana_value }
	}
}
wc_EFFECT_magical_TRAIT_effect = { # add_trait/add_trait_force_tooltip/other with wc_start_mana_regeneration_loop_effect for any trait that gives mana
	$EFFECT$ = $TRAIT$
	wc_start_mana_regeneration_loop_effect = yes # Starts mana regeneration loop
}