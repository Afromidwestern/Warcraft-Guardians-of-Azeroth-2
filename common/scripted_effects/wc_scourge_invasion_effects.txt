scourge_start_pack_effect = {
	add_gold = massive_gold_max_value
	add_prestige = monumental_prestige_gain
	add_piety = massive_piety_gain
	
	add_dread = 100
	
	spawn_scourge_troops_effect = yes
	spawn_scourge_troops_effect = yes
	spawn_scourge_troops_effect = yes
	spawn_scourge_troops_effect = yes
}
scourge_603_pack_effect = {
	add_gold = massive_gold_max_value
	add_prestige = monumental_prestige_gain
	add_piety = massive_piety_gain
	
	add_dread = 100
	
	spawn_scourge_troops_effect = yes
	spawn_scourge_troops_effect = yes
	
	create_story = story_scourge_invasion
}
spawn_scourge_troops_effect = {
	if = {
		limit = { exists = capital_province }
		spawn_army = {
			uses_supply = no
			inheritable = yes
			name = scourge_event_troops
			levies = {
				value = 1500
			}
			men_at_arms = {
				type = light_footmen
				stacks = 3
			}
			men_at_arms = {
				type = bowmen
				stacks = 2
			}
			men_at_arms = {
				type = aerial_unit
				stacks = 1
			}
			men_at_arms = {
				type = armored_horsemen
				stacks = 1
			}
			men_at_arms = {
				type = trebuchet
				stacks = 5
			}
			location = capital_province
		}
	}
}
try_to_set_scourge_story_owner = {
	if = {
		limit = {
			exists = title:e_scourge.holder
			OR = {
				story_owner = title:e_scourge.holder
				$OWNER$ = title:e_scourge.holder
			}
		}
		make_story_owner = $OWNER$
	}
	else = {
		end_scourge_effect = yes
	}
}
scourge_offer_vassalization_effect = {
	save_scope_as = actor
	save_scope_value_as = {
		name = turns_undead
		value = yes
	}
	
	$TITLE$ = {
		every_de_jure_top_liege = {
			limit = {
				highest_held_title_tier < tier_kingdom
				faith = faith:odyn
				is_ai = yes
			}
			save_scope_as = recipient
			
			offer_vassalization_interaction_effect = yes
		}
	}
}

find_scourge_jailer_and_save_to_scope_effect = {
	if = {
		limit = { any_scourge_jailer_is_avaliable_trigger = yes }
		if = {
			limit = {
				exists = scope:story
				scope:story = { story_type = story_scourge_invasion }
			}
		}
		else = {
			random_owned_story = {
				limit = { story_type = story_scourge_invasion }
				save_scope_as = story
			}
		}
	}
	
	scope:story = {
		random_in_list = {
			variable = nerzhul_jailors
			
			limit = { is_avaliable_scourge_jailer_trigger = yes }
			
			save_scope_as = scourge_jailer
		}
	}
}

imprison_scourge_jailor_consequences_effect = {
	$DREADLORD$ = { save_scope_as = dreadlord }
	if = {
		limit = {
			scope:dreadlord = { is_scourge_jailer_of_trigger = { TARGET = $SCOURGE$ } }
			NOT = {
				scope:killer = {
					any_secret = {
						secret_target = scope:dreadlord
						secret_type = secret_murder
					}
				}
			}
		}
		
		$SCOURGE$ = {
			if = {
				limit = { any_scourge_jailer_is_avaliable_trigger = yes }
				trigger_event = { id = WCCSC.15 days = 3 }
			}
		}
	}
}

end_scourge_effect = {
	custom_description = {
		text = end_scourge_tooltip
		on_end_scourge_effect = yes
		if = {
			limit = { exists = scope:story }
			scope:story = { end_story = yes }
		}
	}
}
on_end_scourge_effect = {
	if = {
		limit = { exists = title:e_scourge.holder }
		shatter_realm_effect = { WINNER = title:e_scourge.holder LOSER = title:e_scourge.holder }
	}
}