create_new_titanforged_courtier = {

	set_local_variable = {
		name = titan_forge_lvl 
		value = {
			value = 0
			add = titan_forge_highest_level_owned
			min = 1
		} 
	}
	
	set_local_variable = {
		name = courtiers_num 
		value = { 1 local_var:titan_forge_lvl }
	}
	
	while = {
		count = local_var:courtiers_num
		
		if = {
			limit = { has_trait = creature_mechagnome }
			if = {
				limit = { local_var:titan_forge_lvl < 2	}
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = low_lvl_titanforged_machagnome_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			else_if = {
				limit = { local_var:titan_forge_lvl < 4	}
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = mid_lvl_titanforged_machagnome_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			else_if = {
				limit = { local_var:titan_forge_lvl < 6	}
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = high_lvl_titanforged_machagnome_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			else_if = {
				limit = { local_var:titan_forge_lvl <= 7 }
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = very_high_lvl_titanforged_machagnome_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
		}
		else_if = {
			limit = { has_trait = creature_watcher }
			
			if = {
				limit = { local_var:titan_forge_lvl < 2	}
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = low_lvl_titanforged_watcher_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			else_if = {
				limit = { local_var:titan_forge_lvl < 4	}
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = mid_lvl_titanforged_watcher_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			else_if = {
				limit = { local_var:titan_forge_lvl < 6	}
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = high_lvl_titanforged_watcher_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			else_if = {
				limit = { local_var:titan_forge_lvl <= 7 }
				create_character = {
					location = root.capital_province
					gender_female_chance = 50
					template_character = very_high_lvl_titanforged_watcher_character_template
					
					faith = root.faith
					
					age = 18
					
					after_creation = {
						copy_inheritable_appearance_from = root
					}
				}
			}
			}
		}
	}
}