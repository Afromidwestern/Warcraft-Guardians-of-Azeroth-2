namespace = horde_invasion

#########################################
#
#	Horde Invasion events - CK3 Edition
#
#########################################

# Setup Blackhand and the associated story
horde_invasion.0001 = {
	type = empty
	hidden = yes
	
	trigger = {
		year = 583
		NOT = { exists = global_var:dark_portal_was_opened }
	}

	immediate = {
		debug_log = "The Horde has appeared!"
		debug_log_date = yes
		set_horde_characters_effect = yes
		scope:blackhand = {
			create_story = story_horde_invasion
			save_scope_as = story_owner
		}
	}
}

# Starts the Horde Invasion
horde_invasion.0002 = {
	type = narrative_event
	title = horde_invasion.0002.title
	desc = horde_invasion.0002.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:blackhand
		animation = personality_bold
	}

	immediate = {
		debug_log = "The Horde has declared war on Stormwind!"
		debug_log_date = yes
		set_global_variable =  {
			name = dark_portal_was_opened
			value = yes
		}
		declare_war_on_stormwind_effect = yes
	}

	option = { # Corrupted orcs option
		trigger = {
			NOT = { 
				faith = faith:orcish_shamanism
			}
			faith = faith:orcish_fel
		}
		name = horde_invasion.0002.a
	}

	option = { # Frostwolf option
		trigger = {
			NOT = { 
				faith = faith:orcish_fel
			}
			faith = faith:orcish_shamanism
		}
		name = horde_invasion.0002.b
	}
	
	option = { # Outsider option
		trigger = {
			NOT = { 
				faith = faith:orcish_shamanism
				faith = faith:orcish_fel
			}
		}
		name = horde_invasion.0002.c
	}
}

### TODO: Frostwolf Exodus ###

# Author notes: check CK2 pull request 856 for additional flavor

# Frostwolf Exodus: Start
horde_invasion.0003 = {
	type = narrative_event
	title = horde_invasion.0003.title
	desc = horde_invasion.0003.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = worry
	}

	immediate = {
		debug_log = "Frostwolf Exodus has begun"
		debug_log_date = yes
	}

	option = {
		# We have to go north
		name = horde_invasion.0003.a
		custom_tooltip = horde_invasion.0003.a_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0004 days = 21 }
		}
	}
	option = {
		# We have to go south
		name = horde_invasion.0003.b
		custom_tooltip = horde_invasion.0003.b_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0013 days = 7 }
		}
	}
	option = {
		# Stay here and look for allies
		name = horde_invasion.0003.c
		custom_tooltip = horde_invasion.0003.c_tt
	}
}

# Frostwolf Exodus: Northern route
# Delayer event
horde_invasion.0004 = {
	type = empty
	hidden = yes

	immediate = {
		scope:durotan = {
			if = {
				limit = { frostwolf_exodus_d_frostwolf_trigger = yes }
				trigger_event = { id = horde_invasion.0005 }
			}
			else = {
				trigger_event = { id = horde_invasion.0200 }
			}
		}
	}
}

# Frostwolf Exodus: Khaz Modan
horde_invasion.0005 = {
	type = narrative_event
	title = horde_invasion.0005.title
	desc = horde_invasion.0005.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	option = {
		# Go north
		name = horde_invasion.0005.a
		custom_tooltip = horde_invasion.0005.a_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0006 days = 31 }
		}
	}
	option = {
		# Go west
		name = horde_invasion.0005.b
		custom_tooltip = horde_invasion.0005.b_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0010 days = 31 }
		}
	}
}

# Frostwolf Exodus: Northern route, continued
# Delayer event
horde_invasion.0006 = {
	type = empty
	hidden = yes

	immediate = {
		scope:durotan = {
			if = {
				limit = { frostwolf_exodus_d_frostwolf_trigger = yes }
				trigger_event = { id = horde_invasion.0007 }
			}
			else = {
				trigger_event = { id = horde_invasion.0200 }
			}
		}
	}
}

# Frostwolf Exodus: Alterac Mountains
horde_invasion.0007 = {
	type = narrative_event
	title = horde_invasion.0007.title
	desc = horde_invasion.0007.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	option = {
		# Settle in Alterac Valley
		name = horde_invasion.0007.a
		custom_tooltip = horde_invasion.0007.a_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0008 days = 7 }
		}
	}
}

# Frostwolf Exodus: Alterac Settlement delayer
# Delayer event
horde_invasion.0008 = {
	type = empty
	hidden = yes

	immediate = {
		scope:durotan = {
			if = {
				limit = { frostwolf_exodus_d_frostwolf_trigger = yes }
				trigger_event = { id = horde_invasion.0009 }
			}
			else = {
				trigger_event = { id = horde_invasion.0200 }
			}
		}
	}
}

# Frostwolf Exodus: Alterac Settlement
horde_invasion.0009 = {
	type = narrative_event
	title = horde_invasion.0009.title
	desc = horde_invasion.0009.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	# TODO: Settlement and related scripted effects

	option = {
		# Narrative event broadcasting Frostwolf settlement
		name = horde_invasion.0009.a
		every_player = {
			trigger_event = { id = horde_invasion.0100 }
		}
	}
}

# Frostwolf Exodus: Western route
# Delayer event
horde_invasion.0010 = {
	type = empty
	hidden = yes

	immediate = {
		scope:durotan = {
			if = {
				limit = { frostwolf_exodus_d_frostwolf_trigger = yes }
				trigger_event = { id = horde_invasion.0011 }
			}
			else = {
				trigger_event = { id = horde_invasion.0200 }
			}
		}
	}
}

# Frostwolf Exodus: Western Khaz Modan
horde_invasion.0011 = {
	type = narrative_event
	title = horde_invasion.0011.title
	desc = horde_invasion.0011.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	option = {
		# Settle in the western shore
		name = horde_invasion.0011.a
		custom_tooltip = horde_invasion.0011.a_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0012 days = 7 }
		}
	}
}

# Frostwolf Exodus: Western Shore Settlement
horde_invasion.0012 = {
	type = narrative_event
	title = horde_invasion.0012.title
	desc = horde_invasion.0012.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	# TODO: Settlement and related scripted effects

	option = {
		# Narrative event broadcasting Frostwolf settlement
		name = horde_invasion.0012.a
		every_player = {
			trigger_event = { id = horde_invasion.0100 }
		}
	}
}

# Frostwolf Exodus: Southern route
# Delayer event
horde_invasion.0013 = {
	type = empty
	hidden = yes

	immediate = {
		scope:durotan = {
			if = {
				limit = { frostwolf_exodus_d_frostwolf_trigger = yes }
				trigger_event = { id = horde_invasion.0014 }
			}
			else = {
				trigger_event = { id = horde_invasion.0200 }
			}
		}
	}
}

# Frostwolf Exodus: Stranglethorn
horde_invasion.0014 = {
	type = narrative_event
	title = horde_invasion.0014.title
	desc = horde_invasion.0014.desc
	theme = war
	override_background = {
		reference = wc_background_stranglethorn
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	option = {
		# Let's continue
		name = horde_invasion.0014.a
		custom_tooltip = horde_invasion.0014.a_tt
		scope:durotan = {
			trigger_event = { id = horde_invasion.0015 days = 2 }
		}
	}
}

# Frostwolf Exodus: Southern route, cont.
# Delayer event
horde_invasion.0015 = {
	type = empty
	hidden = yes

	immediate = {
		scope:durotan = {
			if = {
				limit = { frostwolf_exodus_d_frostwolf_trigger = yes }
				trigger_event = { id = horde_invasion.0016 }
			}
			else = {
				trigger_event = { id = horde_invasion.0200 }
			}
		}
	}
}

# Frostwolf Exodus: Stranglethorn Settlement
horde_invasion.0016 = {
	type = narrative_event
	title = horde_invasion.0016.title
	desc = horde_invasion.0016.desc
	theme = war
	override_background = {
		reference = wc_background_stranglethorn
	}
	left_portrait = {
		character = scope:durotan
		animation = idle
	}

	# TODO: Settlement and related scripted effects

	# Settle Surohi
	option = {
		# Narrative event broadcasting Frostwolf settlement
		name = horde_invasion.0016.a
		every_player = {
			trigger_event = { id = horde_invasion.0100 }
		}
	}
	
	# Settle Nek'mani
	option = {
		# Narrative event broadcasting Frostwolf settlement
		name = horde_invasion.0016.b
		every_player = {
			trigger_event = { id = horde_invasion.0100 }
		}
	}
}

# Frostwolf Exodus: Settled
horde_invasion.0100 = {
	type = narrative_event
	title = horde_invasion.0100.title
	desc = horde_invasion.0100.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = happiness
	}
	
	option = {
		trigger = {
			NOT = { has_culture_group = culture_group:orc_group }
		}
		name = horde_invasion.0100.a
	}
	option = {
		trigger = { is_character = scope:durotan }
		name = horde_invasion.0100.b
		prestige = 200
	}
	option = {
		trigger = { is_character = scope:orgrim }
		name = horde_invasion.0100.c
	}
	option = {
		trigger = {
			NOT = { 
				is_character = scope:durotan
				is_character = scope:orgrim
			}
			has_culture_group = culture:group_orc_group
		}
		name = horde_invasion.0010.d
	}
}

# Frostwolf Exodus: Failure
horde_invasion.0200 = {
	type = character_event
	title = horde_invasion.0200.title
	desc = horde_invasion.0200.desc
	theme = war
	override_background = {
		reference = wc_background_dark_portal
	}
	left_portrait = {
		character = scope:durotan
		animation = sadness
	}

	option = {
		name = horde_invasion.0200.a
	}

# Doomhammer usurps the Horde events

# Medivh events

# Formation of the Alliance of Lordaeron events

# More clans join the invasion

# Gurubashi want to join the Horde

# Frostmane want to join the Horde

# Amani want to join the Horde

# Death Knight creation events

# Dragon Soul events

# Tomb of Sargeras events