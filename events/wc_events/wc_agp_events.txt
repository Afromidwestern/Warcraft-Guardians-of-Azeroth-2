namespace = agp_event

agp_event.1 = {
	type = character_event
	hidden = yes
	
	trigger = {
		is_ai = no
		has_dynasty = no
	}
	
	immediate = {	
		create_character = {
			employer = root
			#template = religious_leader_character
			age = { 92 98 }
			gender = male
			random_traits = yes
			save_scope_as = char
			dynasty = generate
		}
		scope:char = {
			set_age = { value = root.age add = 20 }
			death = natural
		}
		set_father = scope:char		
		set_house = scope:char.house
	}
}

agp_event.4 = {
	type = character_event
	hidden = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					exists = scope:that_faith
				}
				scope:that_faith = {
					remove_doctrine = doctrine_theocracy_lay_clergy add_doctrine = doctrine_theocracy_temporal
					remove_doctrine = doctrine_no_head add_doctrine = doctrine_spiritual_head
					every_in_list = {
						variable = theocrat_rulers
						if = {
							limit = {
								is_alive = yes
								is_ruler = yes
							}
							change_government = theocracy_government
						}
						scope:that_faith = {
							remove_list_variable = { name = theocrat_rulers target = prev }
						}
					}
				}
			}
			if = {
				limit = {
					has_character_flag = temp_rep_gov
				}
				change_government = republic_government
			}
			else_if = {
				limit = {
					has_character_flag = temp_theoc_gov
				}
				change_government = theocracy_government
			}
			else_if = {
				limit = {
					has_character_flag = temp_merc_gov
				}
				change_government = mercenary_government
			}
			else_if = {
				limit = {
					has_character_flag = temp_hol_ord_gov
				}
				change_government = holy_order_government
			}

			if = {
				limit = {
					has_character_flag = temp_law_city
				}
				add_realm_law_skip_effects = city_succession_law
			}
			else_if = {
				limit = {
					has_character_flag = temp_law_bish
				}
				add_realm_law_skip_effects = bishop_theocratic_succession_law
			}
			else_if = {
				limit = {
					has_character_flag = temp_law_merc
				}
				add_realm_law_skip_effects = mercenary_company_succession_law
			}
			else_if = {
				limit = {
					has_character_flag = temp_law_hol_ord
				}
				add_realm_law_skip_effects = holy_order_succession_law
			}

			set_house = scope:house_of_newchar
			#беспощадно убиваем уже ненужного перса
			scope:char = { set_to_lowborn = yes death = natural }
		}
	}
}