namespace = WCSP

# Choosing of land to plague
WCSP.100 = {
	type = character_event
	title = WCSP_100_TITLE
	desc = WCSP_100_DESC
	theme = corruption
	override_background = {
		event_background = dungeon
	}
	left_portrait = scope:actor

	immediate = {
		# Creates list with all baronies that can be plagued
		every_barony = {
			limit = {
				is_title_created = yes
				OR = {
					holder = scope:recipient
					holder = {
						any_liege_or_above = {
							this = scope:recipient
						}	
					}
				}
			}
			add_to_list = baronies_to_plague
		}

		# First barony
		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 0
			save_scope_as = first_barony
		}

		# Second barony
		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 1
			save_scope_as = second_barony
		}

		# Third barony
		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 2
			save_scope_as = third_barony
		}
	}

	# Option to get first barony
	option = {
		name = WCSP_100_A

		trigger = {
			exists = scope:first_barony
		}

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:first_barony
			}
		}
	}

	# Option to get second barony
	option = {
		name = WCSP_100_B

		trigger = {
			exists = scope:second_barony
		}

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:second_barony
			}
		}
	}

	# Option to get third barony
	option = {
		name = WCSP_100_C

		trigger = {
			exists = scope:third_barony
		}

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:third_barony
			}
		}
	}

	# Option to do nothing
	option = {
		name = WCSP_100_D
	}
}
