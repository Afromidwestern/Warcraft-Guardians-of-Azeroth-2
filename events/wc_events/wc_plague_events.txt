namespace = WCSP

# Choosing of land to plague
WCSP.100 = {
	type = character_event
	title = WCSP_100_TITLE
	desc = WCSP_100_DESC
	theme = corruption
	override_background = {
		event_background = dungeon
	}
	left_portrait = scope:actor

	immediate = {
		every_barony = {
			limit = {
				is_title_created = yes
				OR = {
					holder = scope:recipient
					holder = {
						any_liege_or_above = {
							this = scope:recipient
						}	
					}
				}
			}
			add_to_list = baronies_to_plague
		}

		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 0
			save_scope_as = first_barony
		}

		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 1
			save_scope_as = second_barony
		}

		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 2
			save_scope_as = third_barony
		}
	}

	option = {
		name = WCSP_100_A

		trigger = {
			exists = scope:first_barony
		}

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:first_barony
			}
		}
	}

	option = {
		name = WCSP_100_B

		trigger = {
			exists = scope:second_barony
		}

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:second_barony
			}
		}
	}

	option = {
		name = WCSP_100_C

		trigger = {
			exists = scope:third_barony
		}

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:third_barony
			}
		}
	}

	option = {
		name = WCSP_100_D
	}
}

WCSP.0001 = {
	type = character_event
	title = WCSP_0001_TITLE
	desc = WCSP_0001_DESC
	theme = realm
	left_portrait = root

	immediate = {
		every_barony = {
			limit = {
				is_title_created = yes
				OR = {
					holder = root
					holder = {
						any_liege_or_above = {
							this = root
						}	
					}
				}
				title_province = {
					has_province_modifier = plague_province_modifier
				}
			}
			add_to_list = plagued_baronies
		}

		ordered_in_list = {
			list = plagued_baronies
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 0
			save_scope_as = first_barony
		}

		ordered_in_list = {
			list = plagued_baronies
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 1
			save_scope_as = second_barony
		}

		ordered_in_list = {
			list = plagued_baronies
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 2
			save_scope_as = third_barony
		}
	}

	option = {
		name = WCSP_0001_A

		trigger = {
			exists = scope:first_barony
		}

		root = {
			set_variable = {
				name = purge_event_tick
				value = 0
			}
			set_variable = {
				name = purge_event_barony
				value = scope:first_barony
			}
		}

		trigger_event = {
			on_action = purge_start_pulse
			days = 2
		}
	}

	option = {
		name = WCSP_0001_B

		trigger = {
			exists = scope:second_barony
		}

		root = {
			set_variable = {
				name = purge_event_tick
				value = 0
			}
			set_variable = {
				name = purge_event_barony
				value = scope:second_barony
			}
		}

		trigger_event = {
			on_action = purge_start_pulse
			days = 2
		}
	}

	option = {
		name = WCSP_0001_C

		trigger = {
			exists = scope:third_barony
		}

		root = {
			set_variable = {
				name = purge_event_tick
				value = 0
			}
			set_variable = {
				name = purge_event_barony
				value = scope:third_barony
			}
		}

		trigger_event = {
			on_action = purge_start_pulse
			days = 2
		}
	}

	option = {
		name = WCSP_0001_D
	}
}