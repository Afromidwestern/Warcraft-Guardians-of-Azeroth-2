namespace = WCSP

# Choosing of land to plague
WCSP.100 = {
	type = character_event
	title = WCSP_100_TITLE
	desc = WCSP_100_DESC
	theme = corruption
	override_background = {
		#reference = physicians_study
		event_background = dungeon
	}
	left_portrait = scope:actor

	immediate = {
		#scopes, save 3 counties with more levies
		every_barony = {
			limit = {
				is_title_created = yes
				OR = {
					holder = scope:recipient
					holder = {
						any_liege_or_above = {
							this = scope:recipient
						}	
					}
				}
			}
			add_to_list = baronies_to_plague
		}

		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 0
			save_scope_as = first_barony
		}

		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 1
			save_scope_as = second_barony
		}

		ordered_in_list = {
			list = baronies_to_plague
			order_by = {
				value = 0
				title_province = {
					add = building_levies
				}
			}
			position = 2
			save_scope_as = third_barony
		}
	}

	option = {
		name = WCSP_100_A

		# scope:first_barony = {
		# 	save_scope_as = plagued_barony
		# }

		# scope:recipient = {
		# 	set_variable = {
		# 		name = plagued_barony
		# 		value = scope:first_barony
		# 	}
		# }

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:first_barony
			}
		}
	}

	option = {
		name = WCSP_100_B

		# scope:second_barony = {
		# 	save_scope_as = plagued_barony
		# }

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:second_barony
			}
		}
	}

	option = {
		name = WCSP_100_C

		# scope:third_barony = {
		# 	save_scope_as = plagued_barony
		# }

		start_scheme = {
			type = plague
			target = scope:recipient
		}

		random_scheme = {
			limit = {
				scheme_type = plague
				scheme_target = scope:recipient
			}
			set_variable = {
				name = plagued_barony
				value = scope:third_barony
			}
		}
	}

	option = {
		name = WCSP_100_D
	}
}