namespace = WCPLF

# Faction Created Notification
WCPLF.100 = {
	type = character_event
	title = WCPLF_100_TITLE
	desc = {
		desc = WCPLF_100_DESC_beg
		first_valid = {
			triggered_desc = {
				trigger = {
					scope:faction_leader = { is_in_pol_faction_trigger = { faction = horde } }
				}
				desc = WCPLF_100_DESC_horde
			}
			desc = WCPLF_100_DESC_alliance
		}
	}
	theme = alliance
	override_background = {
		event_background = throne_room_scope
	}
	left_portrait = scope:faction_leader
	
	immediate = {
		scope:faction_leader = {
			save_scope_as = background_throne_room_scope
		}
	}

	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							this = scope:faction_leader
						}
						desc = FOR_FACTION
					}
					triggered_desc = {
						trigger = {
							trigger_if = {
								limit = { scope:faction_leader = { is_in_pol_faction_trigger = { faction = alliance } } }
								has_alliance_religion_trigger = yes
								has_alliance_culture_trigger = yes
							}
							trigger_else = {
								has_horde_religion_trigger = yes
								has_horde_culture_trigger = yes
							}
						}
						desc = WCPLF_100_OPT_pos
					}
					triggered_desc = {
						trigger = {
							trigger_if = {
								limit = { scope:faction_leader = { is_in_pol_faction_trigger = { faction = horde } } }
								has_alliance_religion_trigger = yes
								has_alliance_culture_trigger = yes
							}
							trigger_else = {
								has_horde_religion_trigger = yes
								has_horde_culture_trigger = yes
							}
						}
						desc = WCPLF_100_OPT_neg
					}
					desc = WCPLF_100_OPT_neu
				}
			}
		}
	}
}

### Joining
# Someone wishs to join your faction
WCPLF.150 = {
	type = letter_event
	opening = {
		desc = call_ally.0001.opening
	}
	desc = WCPLF_150_DESC
	sender = scope:actor
	
	trigger = {
		trigger_if = {
			limit = { scope:joining_faction = flag:alliance }
			is_in_pol_faction_trigger = { faction = alliance }
		}
		trigger_else = {
			is_in_pol_faction_trigger = { faction = horde }
		}
	}

	option = {
		name = ACCEPT_OPT
		
		scope:actor = { trigger_event = WCPLF.155 }
		
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = DECLINE_OPT
		
		scope:actor = { trigger_event = WCPLF.160 }
		
		ai_chance = {
			base = 0
		}
	}
}
# Faction accepts you
WCPLF.155 = {
	type = letter_event
	opening = {
		desc = call_ally.0001.opening
	}
	desc = WCPLF_155_DESC
	sender = scope:recipient

	option = {
		name = GREAT_OPT
		
		if = {
			limit = { scope:joining_faction = flag:alliance }
			join_pol_faction_effect = { faction = alliance }
		}
		else = {
			join_pol_faction_effect = { faction = horde }
		}
	}
}
# Faction declines you
WCPLF.160 = {
	type = letter_event
	opening = {
		desc = call_ally.0001.opening
	}
	desc = WCPLF_160_DESC
	sender = scope:recipient

	option = {
		name = ALAS_OPT
	}
}

# Faction Created Notification
WCPLF.200 = {
	type = character_event
	title = WCPLF_100_TITLE
	desc = WCPLF_200_DESC
	theme = alliance
	left_portrait = scope:faction_leader
	
	immediate = {
		save_scope_as = faction_leader
	}

	option = {
		name = FOR_FACTION
	}
}

# Faction Created Notification
WCPLF.250 = {
	type = character_event
	title = WCPLF_100_TITLE
	desc = WCPLF_250_DESC
	theme = alliance
	override_background = {
		event_background = throne_room_scope
	}
	left_portrait = scope:former_leader
	
	immediate = {
		save_scope_as = me
		scope:former_leader = {
			save_scope_as = faction_leader
			save_scope_as = background_throne_room_scope
		}
	}

	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							trigger_if = {
								limit = { scope:former_leader = { is_former_member_of_pol_faction_trigger = { faction = alliance } } }
								is_former_member_of_pol_faction_trigger = { faction = alliance }
							}
							trigger_else = {
								is_former_member_of_pol_faction_trigger = { faction = horde }
							}
						}
						desc = ALAS_OPT
					}
					desc = WCPLF_250_OPT_a
				}
			}
		}
	}
	
	after = {
		remove_variable = former_faction
	}
}

### Inviting
# Invite to Union - Auto-Accepted
WCPLF.300 = {
	type = letter_event
	opening = {
		desc = char_interaction.0070.opening
	}
	desc = WCPLF_300_DESC
	
	sender = scope:actor

	option = {
		name = char_interaction.0234.a
	}
}
# Invite to Union - Accepted
WCPLF.305 = {
	type = letter_event
	opening = {
		desc = char_interaction.0010.opening
	}
	desc = WCPLF_305_DESC
	
	sender = scope:recipient

	immediate = {
		show_as_tooltip = {
			invite_to_pol_faction_effect = yes
		}
	}

	option = {
		name = MARVELOUS_NEWS
	}
}
# Invite to Union - Refused
WCPLF.310 = {
	type = letter_event
	opening = {
		desc = char_interaction.0001.opening
	}
	desc = WCPLF_310_DESC
	
	sender = {
		character = scope:recipient
		animation = dismissal
	}

	option = {
		name = TROUBLING
	}
}